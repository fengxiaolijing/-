# 腾讯蓝鲸

官网文档中心

https://bk.tencent.com/docs/

官网安装

https://cloud.tencent.com/developer/labs/lab/10386

## 一 安装

### 基础环境配置

```
# 禁用警报
[root@master install]# setenforce 0
[root@master install]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux

# 禁用防火墙
[root@master install]#  systemctl stop firewalld    # 停止firewalld
[root@master install]# systemctl disable firewalld # 禁用firewall开机启动
Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.
Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.

#最大文件打开数
cat <<EOF > /etc/security/limits.d/99-nofile.conf
 root soft nofile 102400
 root hard nofile 102400
 EOF

 # 时间差距小于1秒
 [root@master install]#  ntpdate cn.pool.ntp.org
 4 Nov 17:12:25 ntpdate[82070]: adjust time server 51.158.186.98 offset 0.017764 sec

#配置yum源
#备份
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
# 下载yum
wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.cloud.tencent.com/repo/centos7_base.repo
# 缓存更新
yum clean all
yum makecache

#配置epel源
#备份
mv /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.backup
#下载腾讯epel7
wget -O /etc/yum.repos.d/epel.repo http://mirrors.cloud.tencent.com/repo/epel-7.repo
#更新缓存
yum clean all
yum makecache

# 解压安装包
tar xf bkce_src-4.1.16.tgz -C data/

获取机器mac地址后再官网下载证书信息 
https://bk.tencent.com/download_ssl/
#解压证书
tar xf ssl_certificates.tar.gz -C data/src/cert/
```

### 安装全部插件

```
[root@master ~]# cd data/install/
[root@master install]# ./install_minibk -y
```



## 二 修改配置

 配置登录密码

/data/install/globals.env

```
 52 export PAAS_ADMIN_USER=admin
 53 export PAAS_ADMIN_PASS='Password'
```

配置域名信息

```
 26 # 域名信息
 27 export BK_DOMAIN="bk.com"            # 蓝鲸根域名(不含主机名)
 28 #export BK_DOMAIN="需要配置的域名.com"            # 蓝鲸根域名(不含主机名)
 29 export PAAS_FQDN="paas.$BK_DOMAIN"       # PAAS 完整域名
 30 export CMDB_FQDN="cmdb.$BK_DOMAIN"       # CMDB 完整域名
 31 export JOB_FQDN="job.$BK_DOMAIN"         # JOB 完整域名
 32 export APPO_FQDN="o.$BK_DOMAIN"          # 正式环境完整域名
 33 export APPT_FQDN="t.$BK_DOMAIN"          # 测试环境完整域名
```

此配置文件还有mysql等账号密码此处省略默认



## 三 运行安装脚本

运行安装命令

```
cd /data/install 
./install_minibk -y
```

解决了一堆bug

xxxx

xxxx

xxxx

遇到下面提示`enter a absolute path [/data/bkce]:` 摁回车键

```
[root@swarm install]# ./install_minibk -y
[10.0.110.201]20191106-152300 37   install.config exists. backup it to install.config.20191106_152300
‘install.config’ -> ‘install.config.20191106_152300’
start <<check_ssh_nopass>> ... [OK]
start <<check_password>> ... [OK]
start <<check_cert_mac>> ... [OK]
xxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxx
enter a absolute path [/data/bkce]:    #  回车
```

运行一段时间后会提示，是否同意蓝鲸的用户授权协议  输入yes

```
------------------------- agreements ---------------------------------
    Dear users, welcome to use the Tencent BlueKing Software. Please
access http://bk.tencent.com/info/#laws to read the Tencent BlueKing
Software License and Service Agreement carefully. You have no right to
install or use the Software and related services unless you have read
and accepted all the terms of this Agreement. By downloading, install-
ing, using or logging in the Software, you shall be deemed to have
read and agreed to be bound by the Agreement above. If you have under-
stood the above content, please enter "yes" to continue installation,
otherwise, please enter "no" to abort. Thank you for your understan-
ding and support of the Tencent BlueKing Software. 
----------------------------------------------------------------------
yes/no ?yes              #yes

```

## 四 访问蓝鲸

本地联系

```
windows: C:\windows\system32\drivers\etc\hosts
linux/mac: /etc/hosts
```

三个域名

```
<您的 IP 地址> paas.bk.com
<您的 IP 地址> cmdb.bk.com
<您的 IP 地址> job.bk.com
```

用户名密码

```
用户名：admin
密　码：Password
```

特别提示 ：  必须用谷歌浏览器进行访问

访问 paas.bk.com  输入账号密码进入平台

